import{w as l,g as a,t as o}from"./utilities-CT1sfag7.js";class r{constructor(t){this.nav=t,this.navID=this.nav.id,this.openNavButton=document.querySelector(".js-open-nav"),this.closeNavButtons=this.nav.querySelectorAll(".js-close-nav"),this.closeSubNavButtons=this.nav.querySelectorAll(".js-close-sub-nav"),this.isMegaMenuElement=this.nav.classList.contains("js-mega-menu"),this.mainNavIsOpen=!1,this.transitionEvent=l(),this.mobileShowMainTransitionEndEvent=e=>this.mobileShowMainNav(e),this.mobileHideMainTransitionEndEvent=e=>this.mobileHideMainNav(e),this.showSubNavTransitionEndEvent=e=>this.showSubNav(e),this.mobileTrapTabKeyEvent=e=>this.mobileMainNavTrapTabs(e),this.mobileSubNavTrapTabKeyEvent=e=>this.trapkeyEventStuff(e),this.desktopButtonClickEvent=e=>this.buttonClickDesktop(e),this.desktopButtonKeydownEvent=e=>this.buttonKeydownDesktop(e),this.checkFocusEvent=e=>this.checkIfContainsFocus(e),this.openSubNavElements=[],this.breakpoint=window.matchMedia("(min-width: 62em)")}init(){this.initEvents(),this.responsiveCheck(this.breakpoint),this.nav&&this.breakpoint.addEventListener("change",t=>this.responsiveCheck(t))}initEvents(){this.isMegaMenuElement&&(document.addEventListener("click",this.handleOutsideClick.bind(this),!1),document.addEventListener("keydown",this.escapeClose.bind(this),!1)),this.openNavButton&&this.openNavButton.addEventListener("click",this.mobileToggleMainNav.bind(this),!1),this.closeNavButtons.forEach(t=>{t.addEventListener("click",this.mobileToggleMainNav.bind(this),!1)}),this.closeSubNavButtons.forEach(t=>{t.addEventListener("click",this.closeSubNav.bind(this),!1)})}responsiveCheck(t){let e=[];t.matches?(e=[].slice.call(this.nav.querySelectorAll("ul > li")),document.body.classList.remove("main-nav-active")):e=[].slice.call(this.nav.querySelectorAll("li")),this.tearDownNavControls(),this.setUpNavControls(e)}handleOutsideClick(t){if(this.nav.closest(".nsw-docs")||!this.mainNavIsOpen)return;!this.nav.contains(t.target)&&this.toggleSubNavDesktop(!0)}tearDownNavControls(){this.isMegaMenuElement&&[].slice.call(this.nav.querySelectorAll("li")).forEach(e=>{const s=e.querySelector("[id^=sub-nav-]"),i=e.querySelector("a");s&&(i.removeAttribute("role"),i.removeAttribute("aria-expanded"),i.removeAttribute("aria-controls"),i.removeEventListener("click",this.desktopButtonClickEvent,!1),i.removeEventListener("keydown",this.desktopButtonKeydownEvent,!1))})}setUpNavControls(t){this.isMegaMenuElement&&t.forEach(e=>{const s=e.querySelector("[id^=sub-nav-]"),i=e.querySelector("a");s&&(i.setAttribute("role","button"),i.setAttribute("aria-expanded","false"),i.setAttribute("aria-controls",s.id),i.addEventListener("click",this.desktopButtonClickEvent,!1),i.addEventListener("keydown",this.desktopButtonKeydownEvent,!1))})}mobileMainNavTrapTabs(t){const e=a(this.navID,["> div button","> ul > li > a"]);o(t,e)}mobileShowMainNav({propertyName:t}){t==="transform"&&(a(this.navID,["> div button","> ul > li > a"]).all[1].focus(),this.nav.classList.add("active"),this.nav.classList.remove("activating"),this.nav.removeEventListener(this.transitionEvent,this.mobileShowMainTransitionEndEvent,!1),this.nav.addEventListener("keydown",this.mobileTrapTabKeyEvent,!1))}mobileHideMainNav({propertyName:t}){if(t==="transform"){for(this.nav.classList.remove("active"),this.nav.classList.remove("closing");this.openSubNavElements.length>0;){const{submenu:e}=this.whichSubNavLatest();e.removeEventListener("keydown",this.mobileSubNavTrapTabKeyEvent,!1),e.classList.remove("active"),e.classList.remove("closing"),this.openSubNavElements.pop()}this.nav.removeEventListener(this.transitionEvent,this.mobileHideMainTransitionEndEvent,!1),this.nav.removeEventListener("keydown",this.mobileTrapTabKeyEvent,!1)}}mobileToggleMainNav(t){const{currentTarget:e}=t;e.getAttribute("aria-expanded")==="true"?(document.body.classList.remove("main-nav-active"),this.openNavButton.focus(),this.nav.classList.add("closing"),this.nav.addEventListener(this.transitionEvent,this.mobileHideMainTransitionEndEvent,!1)):(document.body.classList.add("main-nav-active"),this.nav.classList.add("activating"),this.nav.addEventListener(this.transitionEvent,this.mobileShowMainTransitionEndEvent,!1))}buttonClickDesktop(t){(!this.breakpoint.matches||!t.target.closest(".nsw-main-nav__sub-nav"))&&(this.saveElements(t),this.toggleSubNavDesktop(),t.preventDefault())}buttonKeydownDesktop(t){(t.key===" "||t.key==="Enter"||t.key==="Spacebar")&&(this.saveElements(t),this.toggleSubNavDesktop(),t.preventDefault())}escapeClose(t){if(t.key==="Escape"){if(this.nav.closest(".nsw-docs"))return;const{link:e}=this.whichSubNavLatest();e.getAttribute("aria-expanded")==="true"&&(this.toggleSubNavDesktop(!0),t.preventDefault(),e.focus())}}saveElements(t){const{currentTarget:e}=t,s={submenu:document.getElementById(e.getAttribute("aria-controls")),link:e,linkParent:e.parentNode};this.openSubNavElements.push(s)}showSubNav({propertyName:t}){const{submenu:e}=this.whichSubNavLatest();t==="transform"&&(a(e.id,["> div button","> .nsw-main-nav__title a","> ul > li > a"]).all[2].focus(),e.removeEventListener(this.transitionEvent,this.showSubNavTransitionEndEvent,!1))}closeSubNav(){const{submenu:t,link:e}=this.whichSubNavLatest();this.breakpoint.matches?(e.setAttribute("aria-expanded",!1),e.classList.remove("active"),this.nav.removeEventListener("focus",this.checkFocusEvent,!0),this.nav.removeEventListener("click",this.checkFocusEvent,!0)):(e.focus(),t.removeEventListener("keydown",this.mobileSubNavTrapTabKeyEvent,!1)),t.classList.remove("active"),t.closest("ul").parentElement.classList.remove("no-scroll"),this.openSubNavElements.pop()}openSubNav(){const{submenu:t,link:e}=this.whichSubNavLatest();this.breakpoint.matches?(e.setAttribute("aria-expanded",!0),e.classList.add("active"),this.nav.addEventListener("focus",this.checkFocusEvent,!0),this.nav.addEventListener("click",this.checkFocusEvent,!0)):(t.addEventListener("keydown",this.mobileSubNavTrapTabKeyEvent,!1),t.addEventListener(this.transitionEvent,this.showSubNavTransitionEndEvent,!1)),t.closest("ul").parentElement.scrollTop=0,t.closest("ul").parentElement.classList.add("no-scroll"),t.classList.add("active")}toggleSubNavDesktop(){const{link:t}=this.whichSubNavLatest();t.getAttribute("aria-expanded")==="true"?(this.mainNavIsOpen=!1,this.closeSubNav()):(this.mainNavIsOpen=!0,this.openSubNav())}checkIfContainsFocus(t){const{linkParent:e}=this.whichSubNavLatest(),s=e.contains(t.target),i=t.target.closest("a").getAttribute("role")==="button";!s&&i&&this.toggleSubNavDesktop()}whichSubNavLatest(){const t=this.openSubNavElements.length-1;return this.openSubNavElements[t]}trapkeyEventStuff(t){const{submenu:e}=this.whichSubNavLatest(),s=a(e.id,["> div button","> ul > li > a"]);o(t,s)}}Drupal.behaviors.navigation={attach:()=>{once("navigation",".nsw-main-nav").forEach(n=>{const t=new r(n),e=t.buttonKeydownDesktop.bind(t);t.buttonKeydownDesktop=s=>{s.target.closest(".nsw-main-nav__sub-list")===null&&e(s)},t.init()})}};Drupal.behaviors.search={attach:()=>{const n=document.querySelector("#header-search");once("search-open",".js-open-search").forEach(t=>{t.addEventListener("click",()=>{n.hidden=!1,n.querySelector("input").focus()})}),once("search-close",".js-close-search").forEach(t=>{t.addEventListener("click",()=>{n.hidden=!0,n.querySelector(".js-open-search").focus()})})}};
