import{u as c}from"./utilities-CT1sfag7.js";class o{constructor(t){this.element=t,this.prefix="nsw-",this.class="date-picker",this.uID=c("calendar-label"),this.dateClass=`${this.prefix}${this.class}__date`,this.todayClass=`${this.dateClass}--today`,this.selectedClass=`${this.dateClass}--selected`,this.keyboardFocusClass=`${this.dateClass}--keyboard-focus`,this.visibleClass=`${this.prefix}${this.class}--is-visible`,this.months=this.element.getAttribute("data-months")?this.element.getAttribute("data-months"):["January","February","March","April","May","June","July","August","September","October","November","December"],this.dateFormat=this.element.getAttribute("data-date-format")?this.element.getAttribute("data-date-format"):"d-m-y",this.dateSeparator=this.element.getAttribute("data-date-separator")?this.element.getAttribute("data-date-separator"):"/",this.datesDisabled=this.element.getAttribute("data-dates-disabled")?this.element.getAttribute("data-dates-disabled"):"",this.minDate=this.element.getAttribute("data-min-date")?this.element.getAttribute("data-min-date"):"",this.maxDate=this.element.getAttribute("data-max-date")?this.element.getAttribute("data-max-date"):"",this.input=this.element.querySelector(".js-date-input__text"),this.trigger=this.element.querySelector(".js-date-input__trigger"),this.triggerLabel=this.trigger&&this.trigger.getAttribute("aria-label")?this.trigger.getAttribute("aria-label"):"Select a date",this.datePicker=this.element.querySelector(".js-date-picker"),this.body=this.datePicker&&this.datePicker.querySelector(".js-date-picker__dates"),this.navigation=this.datePicker&&this.datePicker.querySelector(".js-date-picker__title-nav"),this.heading=this.datePicker&&this.datePicker.querySelector(".js-date-picker__title-label"),this.close=this.datePicker&&this.datePicker.querySelector(".js-date-picker__close"),this.accept=this.datePicker&&this.datePicker.querySelector(".js-date-picker__accept"),this.multipleInput=this.element.querySelector(".js-date-input-multiple"),this.dateInput=this.multipleInput&&this.multipleInput.querySelector(".js-date-picker-date"),this.monthInput=this.multipleInput&&this.multipleInput.querySelector(".js-date-picker-month"),this.yearInput=this.multipleInput&&this.multipleInput.querySelector(".js-date-picker-year"),this.multiDateArray=[this.dateInput,this.monthInput,this.yearInput],this.dateIndexes=this.getDateIndexes(),this.pickerVisible=!1,this.dateSelected=!1,this.selectedDay=!1,this.selectedMonth=!1,this.selectedYear=!1,this.firstFocusable=!1,this.lastFocusable=!1,this.disabledArray=!1}init(){!this.input&&!this.multipleInput||(this.datePicker||this.initCreateCalendar(),this.disabledDates(),this.resetCalendar(),this.initCalendarAria(),this.initCalendarEvents(),this.placeCalendar())}initCreateCalendar(){const t=`
    <div class="nsw-date-picker js-date-picker" role="dialog" aria-labelledby="${this.uID}">
      <header class="nsw-date-picker__header">
        <div class="nsw-date-picker__title">
          <span class="nsw-date-picker__title-label js-date-picker__title-label" id="${this.uID}"></span>

          <nav>
            <ul class="nsw-date-picker__title-nav js-date-picker__title-nav">
              <li>
                <button class="nsw-icon-button nsw-date-picker__title-nav-btn js-date-picker__year-nav-btn js-date-picker__year-nav-btn--prev" type="button">
                  <span class="material-icons nsw-material-icons">keyboard_double_arrow_left</span>
                </button>
                <button class="nsw-icon-button nsw-date-picker__title-nav-btn js-date-picker__month-nav-btn js-date-picker__month-nav-btn--prev" type="button">
                  <span class="material-icons nsw-material-icons">chevron_left</span>
                </button>
              </li>

              <li>
                <button class="nsw-icon-button nsw-date-picker__title-nav-btn js-date-picker__month-nav-btn js-date-picker__month-nav-btn--next" type="button">
                  <span class="material-icons nsw-material-icons">chevron_right</span>
                </button>
                <button class="nsw-icon-button nsw-date-picker__title-nav-btn js-date-picker__year-nav-btn js-date-picker__year-nav-btn--next" type="button">
                  <span class="material-icons nsw-material-icons">keyboard_double_arrow_right</span>
                </button>
              </li>
            </ul>
          </nav>
        </div>

        <ol class="nsw-date-picker__week">
          <li><div class="nsw-date-picker__day">M<span class="sr-only">onday</span></div></li>
          <li><div class="nsw-date-picker__day">T<span class="sr-only">uesday</span></div></li>
          <li><div class="nsw-date-picker__day">W<span class="sr-only">ednesday</span></div></li>
          <li><div class="nsw-date-picker__day">T<span class="sr-only">hursday</span></div></li>
          <li><div class="nsw-date-picker__day">F<span class="sr-only">riday</span></div></li>
          <li><div class="nsw-date-picker__day">S<span class="sr-only">aturday</span></div></li>
          <li><div class="nsw-date-picker__day">S<span class="sr-only">unday</span></div></li>
        </ol>
      </header>

      <ol class="nsw-date-picker__dates js-date-picker__dates" aria-labelledby="${this.uID}">
        
      </ol>

      <div class="nsw-date-picker__buttongroup">
        <button type="button" class="nsw-button nsw-button--dark-outline-solid js-date-picker__close" value="cancel">Cancel</button>
        <button type="button" class="nsw-button nsw-button--dark js-date-picker__accept" value="ok">OK</button>
      </div>
    </div>`;this.element.insertAdjacentHTML("beforeend",t),this.datePicker=this.element.querySelector(".js-date-picker"),this.body=this.datePicker.querySelector(".js-date-picker__dates"),this.navigation=this.datePicker.querySelector(".js-date-picker__title-nav"),this.heading=this.datePicker.querySelector(".js-date-picker__title-label"),this.close=this.datePicker.querySelector(".js-date-picker__close"),this.accept=this.datePicker.querySelector(".js-date-picker__accept")}initCalendarAria(){this.resetLabelCalendarTrigger();const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.classList.add("sr-only","js-date-input__sr-live"),this.element.appendChild(t),this.srLiveReagion=this.element.querySelector(".js-date-input__sr-live")}initCalendarEvents(){this.input&&this.input.addEventListener("focus",()=>{this.toggleCalendar(!0)}),this.multipleInput&&this.multiDateArray.forEach(t=>{t.addEventListener("focus",()=>{this.hideCalendar()})}),this.trigger&&this.trigger.addEventListener("click",t=>{t.preventDefault(),this.pickerVisible=!1,this.toggleCalendar(),this.trigger.setAttribute("aria-expanded","true")}),this.close&&this.close.addEventListener("click",t=>{t.preventDefault(),this.hideCalendar()}),this.accept&&this.accept.addEventListener("click",t=>{t.preventDefault();const e=this.body.querySelector('button[tabindex="0"]');e&&(this.dateSelected=!0,this.selectedDay=e.innerText,this.selectedMonth=this.currentMonth,this.selectedYear=this.currentYear,this.setInputValue(),this.input?this.input.focus():this.multipleInput&&(this.trigger.focus(),this.hideCalendar()),this.resetLabelCalendarTrigger())}),this.body.addEventListener("click",t=>{t.preventDefault();const e=t.target.closest("button");e&&(this.dateSelected=!0,this.selectedDay=e.innerText,this.selectedMonth=this.currentMonth,this.selectedYear=this.currentYear,this.setInputValue(),this.input?this.input.focus():this.multipleInput&&(this.trigger.focus(),this.hideCalendar()),this.resetLabelCalendarTrigger())}),this.navigation.addEventListener("click",t=>{t.preventDefault();const e=t.target.closest(".js-date-picker__month-nav-btn"),i=t.target.closest(".js-date-picker__year-nav-btn");e&&e.classList.contains("js-date-picker__month-nav-btn--prev")?this.showPrevMonth(!0):e&&e.classList.contains("js-date-picker__month-nav-btn--next")?this.showNextMonth(!0):i&&i.classList.contains("js-date-picker__year-nav-btn--prev")?this.showPrevYear(!0):i&&i.classList.contains("js-date-picker__year-nav-btn--next")&&this.showNextYear(!0)}),window.addEventListener("keydown",t=>{(t.code&&t.code===27||t.key&&t.key.toLowerCase()==="escape")&&(document.activeElement.closest(".js-date-picker")?document.activeElement.closest(".js-date-input").querySelector("input").focus():this.hideCalendar())}),window.addEventListener("click",t=>{!t.target.closest(".js-date-picker")&&!t.target.closest(".js-date-input")&&this.pickerVisible&&this.hideCalendar()}),this.body.addEventListener("keydown",t=>{let e=this.currentDay;t.code&&t.code===40||t.key&&t.key.toLowerCase()==="arrowdown"?(e+=7,this.resetDayValue(e)):t.code&&t.code===39||t.key&&t.key.toLowerCase()==="arrowright"?(e+=1,this.resetDayValue(e)):t.code&&t.code===37||t.key&&t.key.toLowerCase()==="arrowleft"?(e-=1,this.resetDayValue(e)):t.code&&t.code===38||t.key&&t.key.toLowerCase()==="arrowup"?(e-=7,this.resetDayValue(e)):t.code&&t.code===35||t.key&&t.key.toLowerCase()==="end"?(t.preventDefault(),e=e+6-this.getDayOfWeek(this.currentYear,this.currentMonth,e),this.resetDayValue(e)):t.code&&t.code===36||t.key&&t.key.toLowerCase()==="home"?(t.preventDefault(),e-=this.getDayOfWeek(this.currentYear,this.currentMonth,e),this.resetDayValue(e)):t.code&&t.code===34||t.key&&t.key.toLowerCase()==="pagedown"?(t.preventDefault(),this.showNextMonth()):(t.code&&t.code===33||t.key&&t.key.toLowerCase()==="pageup")&&(t.preventDefault(),this.showPrevMonth())}),this.datePicker.addEventListener("keydown",t=>{(t.code&&t.code===9||t.key&&t.key==="Tab")&&this.trapFocus(t)}),this.input&&this.input.addEventListener("keydown",t=>{t.code&&t.code===13||t.key&&t.key.toLowerCase()==="enter"?(this.resetCalendar(),this.resetLabelCalendarTrigger(),this.hideCalendar()):(t.code&&t.code===40||t.key&&t.key.toLowerCase()==="arrowdown"&&this.pickerVisible)&&this.body.querySelector('button[tabindex="0"]').focus()}),this.multipleInput&&this.multiDateArray.forEach(t=>{t.addEventListener("keydown",e=>{e.code&&e.code===13||e.key&&e.key.toLowerCase()==="enter"?(this.resetCalendar(),this.resetLabelCalendarTrigger(),this.hideCalendar()):(e.code&&e.code===40||e.key&&e.key.toLowerCase()==="arrowdown"&&this.pickerVisible)&&this.body.querySelector('button[tabindex="0"]').focus()})})}getCurrentDay(t){return t?this.getDayFromDate(t):new Date().getDate()}getCurrentMonth(t){return t?this.getMonthFromDate(t):new Date().getMonth()}getCurrentYear(t){return t?this.getYearFromDate(t):new Date().getFullYear()}getDayFromDate(t){const e=parseInt(t.split("-")[2],10);return Number.isNaN(e)?this.getCurrentDay(!1):e}getMonthFromDate(t){const e=parseInt(t.split("-")[1],10)-1;return Number.isNaN(e)?this.getCurrentMonth(!1):e}getYearFromDate(t){const e=parseInt(t.split("-")[0],10);return Number.isNaN(e)?this.getCurrentYear(!1):e}showNextMonth(t){this.currentYear=this.currentMonth===11?this.currentYear+1:this.currentYear,this.currentMonth=(this.currentMonth+1)%12,this.currentDay=this.checkDayInMonth(),this.showCalendar(t),this.srLiveReagion.textContent=`${this.months[this.currentMonth]} ${this.currentYear}`}showPrevMonth(t){this.currentYear=this.currentMonth===0?this.currentYear-1:this.currentYear,this.currentMonth=this.currentMonth===0?11:this.currentMonth-1,this.currentDay=this.checkDayInMonth(),this.showCalendar(t),this.srLiveReagion.textContent=`${this.months[this.currentMonth]} ${this.currentYear}`}showNextYear(t){this.currentYear+=1,this.currentMonth%=12,this.currentDay=this.checkDayInMonth(),this.showCalendar(t),this.srLiveReagion.textContent=`${this.months[this.currentMonth]} ${this.currentYear}`}showPrevYear(t){this.currentYear-=1,this.currentMonth%=12,this.currentDay=this.checkDayInMonth(),this.showCalendar(t),this.srLiveReagion.textContent=`${this.months[this.currentMonth]} ${this.currentYear}`}checkDayInMonth(){return this.currentDay>this.constructor.daysInMonth(this.currentYear,this.currentMonth)?1:this.currentDay}static daysInMonth(t,e){return 32-new Date(t,e,32).getDate()}resetCalendar(){let t=!1,e;if(this.input?e=this.input.value:this.multipleInput&&(this.dateInput.value!==""&&this.monthInput.value!==""&&this.yearInput.value!==""?e=`${this.dateInput.value}/${this.monthInput.value}/${this.yearInput.value}`:e=""),this.dateSelected=!1,e!==""){const i=this.getDateFromInput();this.dateSelected=!0,t=i}this.currentDay=this.getCurrentDay(t),this.currentMonth=this.getCurrentMonth(t),this.currentYear=this.getCurrentYear(t),this.selectedDay=this.dateSelected?this.currentDay:!1,this.selectedMonth=this.dateSelected?this.currentMonth:!1,this.selectedYear=this.dateSelected?this.currentYear:!1}disabledDates(){this.disabledArray=[],this.datesDisabled&&this.datesDisabled.split(" ").forEach(e=>{this.disabledArray.push(e)})}convertDateToParse(t){const e=t.split(this.dateSeparator);return`${e[this.dateIndexes[2]]}, ${e[this.dateIndexes[1]]}, ${e[this.dateIndexes[0]]}`}isDisabledDate(t,e,i){let s=!1;const a=new Date(i,e,t),n=new Date(this.convertDateToParse(this.minDate)),r=new Date(this.convertDateToParse(this.maxDate));return this.minDate&&n>a&&(s=!0),this.maxDate&&r<a&&(s=!0),this.disabledArray.length>0&&this.disabledArray.forEach(l=>{const d=new Date(this.convertDateToParse(l));a.getTime()===d.getTime()&&(s=!0)}),s}showCalendar(t){const e=this.constructor.getDayOfWeek(this.currentYear,this.currentMonth,"01");this.body.innerHTML="",this.heading.innerHTML=`${this.months[this.currentMonth]} ${this.currentYear}`;let i=1,s="";for(let a=0;a<6;a+=1)for(let n=0;n<7;n+=1)if(a===0&&n<e)s+="<li></li>";else{if(i>this.constructor.daysInMonth(this.currentYear,this.currentMonth))break;{let r="",l="-1",d;i===this.currentDay&&(l="0"),this.getCurrentMonth()===this.currentMonth&&this.getCurrentYear()===this.currentYear&&i===this.getCurrentDay()&&(r+=` ${this.todayClass}`),this.isDisabledDate(i,this.currentMonth,this.currentYear)&&(r+=` ${this.dateClass}--disabled`,d='aria-disabled="true"'),this.dateSelected&&i===this.selectedDay&&this.currentYear===this.selectedYear&&this.currentMonth===this.selectedMonth&&(r+=` ${this.selectedClass}`),s=`${s}<li><button class="${this.dateClass}${r}" tabindex="${l}" type="button" ${d||""}>${i}</button></li>`,i+=1}}this.body.innerHTML=s,this.pickerVisible||this.datePicker.classList.add(this.visibleClass),this.pickerVisible=!0,t||this.body.querySelector('button[tabindex="0"]').focus(),this.getFocusableElements(),this.placeCalendar()}hideCalendar(){this.datePicker.classList.remove(this.visibleClass),this.pickerVisible=!1,this.firstFocusable=!1,this.lastFocusable=!1,this.trigger&&this.trigger.setAttribute("aria-expanded","false")}toggleCalendar(t){this.pickerVisible?this.hideCalendar():(this.resetCalendar(),this.showCalendar(t))}static getDayOfWeek(t,e,i){let s=new Date(t,e,i).getDay()-1;return s<0&&(s=6),s}getDateIndexes(){const t=this.dateFormat.toLowerCase().replace(/-/g,"");return[t.indexOf("d"),t.indexOf("m"),t.indexOf("y")]}setInputValue(){this.input?this.input.value=this.getDateForInput(this.selectedDay,this.selectedMonth,this.selectedYear):this.multipleInput&&(this.dateInput.value=this.constructor.getReadableDate(this.selectedDay),this.monthInput.value=this.constructor.getReadableDate(this.selectedMonth+1),this.yearInput.value=this.selectedYear)}getDateForInput(t,e,i){const s=[];return s[this.dateIndexes[0]]=this.constructor.getReadableDate(t),s[this.dateIndexes[1]]=this.constructor.getReadableDate(e+1),s[this.dateIndexes[2]]=i,s[0]+this.dateSeparator+s[1]+this.dateSeparator+s[2]}getDateFromInput(){let t;return this.input?t=this.input.value.split(this.dateSeparator):this.multipleInput&&(t=[this.dateInput.value,this.monthInput.value,this.yearInput.value]),`${t[this.dateIndexes[2]]}-${t[this.dateIndexes[1]]}-${t[this.dateIndexes[0]]}`}static getReadableDate(t){return t<10?`0${t}`:t}resetDayValue(t){const e=this.constructor.daysInMonth(this.currentYear,this.currentMonth);if(t>e)this.currentDay=t-e,this.showNextMonth(!1);else if(t<1){const i=this.currentMonth===0?11:this.currentMonth-1;this.currentDay=this.constructor.daysInMonth(this.currentYear,i)+t,this.showPrevMonth(!1)}else{this.currentDay=t;const i=this.body.querySelector('button[tabindex="0"]');i.setAttribute("tabindex","-1"),i.classList.remove(this.keyboardFocusClass);const s=this.body.getElementsByTagName("button");for(let a=0;a<s.length;a+=1)if(parseInt(s[a].textContent,10)===this.currentDay){s[a].setAttribute("tabindex","0"),s[a].classList.add(this.keyboardFocusClass),s[a].focus();break}this.getFocusableElements()}}resetLabelCalendarTrigger(){this.trigger&&(this.selectedYear&&this.selectedMonth!==!1&&this.selectedDay?this.trigger.setAttribute("aria-label",`Selected date is ${new Date(this.selectedYear,this.selectedMonth,this.selectedDay).toDateString()}`):this.trigger.setAttribute("aria-label",this.triggerLabel))}getFocusableElements(){const t=this.datePicker.querySelectorAll('[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex]:not([tabindex="-1"]), [contenteditable], audio[controls], video[controls], summary');this.getFirstFocusable(t),this.getLastFocusable(t)}getFirstFocusable(t){for(let e=0;e<t.length;e+=1)if((t[e].offsetWidth||t[e].offsetHeight||t[e].getClientRects().length)&&t[e].getAttribute("tabindex")!=="-1")return this.firstFocusable=t[e],!0;return!1}getLastFocusable(t){for(let e=t.length-1;e>=0;e-=1)if((t[e].offsetWidth||t[e].offsetHeight||t[e].getClientRects().length)&&t[e].getAttribute("tabindex")!=="-1")return this.lastFocusable=t[e],!0;return!1}trapFocus(t){this.firstFocusable===document.activeElement&&t.shiftKey&&(t.preventDefault(),this.lastFocusable.focus()),this.lastFocusable===document.activeElement&&!t.shiftKey&&(t.preventDefault(),this.firstFocusable.focus())}placeCalendar(){this.datePicker.style.left="0px",this.datePicker.style.right="auto",this.datePicker.getBoundingClientRect().right>window.innerWidth&&(this.datePicker.style.left="auto",this.datePicker.style.right="0px")}}Drupal.behaviors.datepicker={attach:()=>{once("datepicker",".js-date-input__text").forEach(h=>{const t=h.parentNode;t.classList.add("nsw-date-input","js-date-input"),t.dataset.dateSeparator="-";const e=document.createElement("div");e.classList.add("nsw-date-input__wrapper","nsw-form__input-group","nsw-form__input-group--icon"),t.insertBefore(e,h),e.appendChild(h);const i=document.createElement("button");i.classList.add("nsw-button","nsw-button--dark","nsw-button--flex","js-date-input__trigger"),i.type="button";const s=document.createElement("span");s.classList.add("material-icons","nsw-material-icons"),s.focusable=!1,s.ariaHidden=!0,s.innerText="calendar_today",i.appendChild(s),e.appendChild(i);const a=new o(t);a.init(),t.datepicker=a,a.datePicker.role="application";const n=a.showCalendar;a.showCalendar=r=>{document.querySelectorAll(".js-date-input").forEach(l=>{l.isEqualNode(t)||l.datepicker.hideCalendar()}),n.apply(a,[r])}})}};
